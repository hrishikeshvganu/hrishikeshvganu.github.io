#+title: Building a SOTA Search Ranking System
*** Ranking errors on the first page are worse than those on later pages
In both cases in the figure, there are 2 products that are ranked incorrectly. The one on left is worse.
#+CAPTION: All ranking errors are not the same
#+ATTR_HTML: :alt ranking_diff :title Action! :align right
[[file:img/myimage.png]]

**** Capturing this property through ML is not easy
A loss like NDCG takes into account this consideration.
$$NDCG@k = \sum_{1}^{k}GAIN(i) DISCOUNT(i) $$
Note: I use x<- y  to denote that x depends on y.
- DISCOUNT depends on the rank (r).
- DISCOUNT<-Rank<- Predicted score ($S_i$)
- $S_{i}$<-$\Theta$ (parameters over which the NDCG can be optimized)
However the rank of a product is a step function of the predicted score.



*Therefore need to find a proxy that's differentiable and is a tight upper bound for NDCG or similar losses that matter to business*
